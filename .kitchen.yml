---
driver:
  name: docker

provisioner:
  name: chef_zero

platforms:
  - name: arch
    driver_config:
      image: 'logankoester/archlinux-chef'
      platform: arch
      disable_upstart: true
      require_chef_omnibus: false
      provision_command:
        - pacman -S --noconfirm --needed supervisor
      run_command: 'sh -c "/usr/sbin/sshd -o UseDNS=no -o UsePAM=no -o PasswordAuthentication=yes && /usr/sbin/supervisord -c /etc/supervisord.conf -n"'

suites:
  - name: default
    driver_config:
      hostname: default
    run_list:
      - 'recipe[supervisor]'
      - 'recipe[website]'
    attributes:
      nginx:
        supervisor: true
      sites:
        'default.example':
          server_names:
            - 'default.example'
            - 'www.default.example'
          owner: 'default'
          root: '/sites/default.example'
          php: true
          wordpress:
            db:
              name: 'default'
              user: 'default'
              pass: 'default'
              host: 'localhost'
              prefix: 'wp_'
            allow_multisite: false
            wp_siteurl: 'https://default.example/'
            wp_home: 'https://default.example/'

          ssl:
            common_name: 'default.example'
